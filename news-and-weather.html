<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>News & Weather â€“ Essential Radio</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #00818a, #7e1974);
      color: white;
      padding: 20px;
    }
    .header {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 30px;
    }
    .logo {
      width: 120px;
      filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.4));
    }
    h1 {
      font-size: 28px;
      font-weight: 600;
    }
    .content-card {
      background: #111;
      border: 1px solid #333;
      border-radius: 12px;
      padding: 30px;
      max-width: 900px;
      margin: 0 auto 40px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    }
    .content-card h2 {
      color: #00e0ff;
      margin-top: 0;
    }
    .content-card ul {
      padding-left: 20px;
    }
    .content-card li {
      margin-bottom: 10px;
    }
    .content-card a {
      color: #00e0ff;
      text-decoration: none;
    }
    .content-card a:hover {
      text-decoration: underline;
    }
    footer {
      margin-top: 60px;
      text-align: center;
      font-size: 14px;
      opacity: 0.8;
    }
  </style>
</head>
<body>
  <div class="header">
    <img src="ERLogo2.png" alt="Essential Radio Logo" class="logo" />
    <h1>News & Weather</h1>
  </div>

  <div class="content-card">
    <h2>Latest Headlines</h2>
    <ul id="news-list"><li>Loading news...</li></ul>
  </div>

  <div class="content-card">
    <h2>Weather Update</h2>
    <p id="weather-update">Loading forecast...</p>
  </div>

  <footer>Essential Radio &copy; 2025</footer>

  <script>
    // Fetch and show latest Radio News Hub headlines
    fetch('https://api.allorigins.win/get?url=' + encodeURIComponent('http://www.radionewshub.co.uk/sitemaps/news.php?feed=H2lujdhEZ3'))
      .then(response => response.json())
      .then(data => {
        const parser = new DOMParser();
        const xml = parser.parseFromString(data.contents, "text/xml");
        const items = xml.querySelectorAll("item");
        const newsList = document.getElementById("news-list");
        newsList.innerHTML = "";
        for (let i = 0; i < Math.min(5, items.length); i++) {
          const title = items[i].querySelector("title").textContent;
          const link = items[i].querySelector("link").textContent;
          const li = document.createElement("li");
          li.innerHTML = `<a href="${link}" target="_blank">${title}</a>`;
          newsList.appendChild(li);
        }
      })
      .catch(error => {
        document.getElementById("news-list").innerHTML = "<li>Failed to load news.</li>";
      });

    // Fetch and extract latest weather forecast from weather_script.log
    fetch('weather_script.log')
      .then(response => response.text())
      .then(log => {
        const lines = log.split('\n').reverse(); // Start from the end
        for (let line of lines) {
          if (line.includes("Weather text:")) {
            const forecast = line.split("Weather text:")[1].trim();
            document.getElementById("weather-update").textContent = forecast;
            return;
          }
        }
        document.getElementById("weather-update").textContent = "Weather forecast unavailable.";
      })
      .catch(error => {
        document.getElementById("weather-update").textContent = "Could not load weather data.";
      });
  </script>
</body>
</html>
