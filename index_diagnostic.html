<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Now Playing Diagnostic (API vs latestTrack.json)</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root { --bg:#0b1220; --fg:#e6edf3; --muted:#9aa3ad; --accent:#fed351; --ok:#19ff9c; --bad:#ff6b6b; }
  html,body{margin:0;height:100%}
  body{background:var(--bg);color:var(--fg);font:15px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;display:flex;align-items:center;justify-content:center;padding:18px}
  .card{width:min(900px,100%);background:#0f1a33;border-radius:16px;box-shadow:0 6px 20px rgba(0,0,0,.25);padding:18px 18px 16px}
  h1{font-size:18px;margin:0 0 8px}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin:12px 0}
  .box{background:#0b162b;border:1px solid #16264b;border-radius:12px;padding:12px}
  .label{font-size:12px;color:var(--muted);margin-bottom:6px}
  .val{font-weight:600}
  code{background:#0b162b;padding:2px 6px;border-radius:6px}
  .live{color:var(--ok);font-weight:700}
  .idle{color:var(--muted)}
  .diff-bad{background:rgba(255,107,107,.15);border-color:rgba(255,107,107,.35)}
  .footer{color:var(--muted);font-size:12px;margin-top:10px}
  button{background:#17305f;color:#fff;border:1px solid #2b4d8c;border-radius:10px;padding:8px 10px;cursor:pointer}
  button:hover{filter:brightness(1.1)}
</style>
</head>
<body>
  <div class="card">
    <h1>Now Playing — Diagnostic</h1>
    <div class="row">
      <div class="box" id="apiBox">
        <div class="label">/api/metadata</div>
        <div class="val" id="apiNow">loading…</div>
        <div class="label" id="apiMeta"></div>
      </div>
      <div class="box" id="latestBox">
        <div class="label">latestTrack.json</div>
        <div class="val" id="ltNow">loading…</div>
        <div class="label" id="ltMeta"></div>
      </div>
    </div>

    <div class="row">
      <div class="box" id="decisionBox">
        <div class="label">Server decision</div>
        <div class="val" id="decision">—</div>
        <div class="label" id="reason"></div>
      </div>
      <div class="box">
        <div class="label">Controls</div>
        <button id="refreshBtn">Refresh</button>
        <span class="label">Auto refresh: <code>10s</code></span>
      </div>
    </div>

    <div class="footer" id="note">Open DevTools → Console to see the raw payloads.</div>
  </div>

  <script src="nowplaying-refresh.diag.js"></script>
</body>
</html>
